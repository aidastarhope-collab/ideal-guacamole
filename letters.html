<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<title>üíå Briefe f√ºr dich</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root{
    --bg:#05353d; --paper:#fff; --text:#374151;
    --wrap:#f5edd1; --flap:#ecdeb8; --body:#e6cfa7;
    --accent:#f59e0b; --btn:#fbbf24; --btn-hover:#fcd34d;
    --seal:#fb18e3;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,sans-serif}
  header{max-width:1100px;margin:24px auto 8px;padding:0 16px}
  h1{margin:0 0 10px}
  .meta{opacity:.9;margin:0 0 10px}
  .actions{display:flex;gap:8px;flex-wrap:wrap}
  .btn{padding:10px 14px;border:0;border-radius:10px;font-weight:700;cursor:pointer}
  .btn.primary{background:#0a5c6d;color:#fff}
  .btn.primary:hover{background:#0d768b}
  .btn.light{background:#f3f4f6;color:#111}

  /* Grid */
  .grid{
    max-width:1100px; margin:18px auto 48px; padding:0 16px;
    display:grid; grid-template-columns:repeat(auto-fit, minmax(300px, 1fr));
    gap:20px;
  }

  /* Karte */
  .card{
    background:var(--wrap);
    border:2px solid var(--accent);
    border-radius:14px;
    padding:16px;
    color:#111;
    display:flex; 
    flex-direction:column;
    gap:16px;
    transition:opacity .2s ease;
    min-height:280px;
  }
  .card.locked{opacity:.4; filter:grayscale(50%)}

  /* Umschlag Container - feste Gr√∂√üe */
  .envelope{
    position:relative;
    width: 100%;
    height:180px;
    background:var(--body);
    border-radius:10px;
    overflow:hidden;
    box-shadow:0 4px 8px rgba(0,0,0,.15);
    perspective: 1000px;
  }

  /* Brief-Inhalt (Papier) - immer sichtbar im Hintergrund */
  .letter{
    position:absolute;
    top:15px; left:15px; right:15px; bottom:15px;
    background:var(--paper);
    color:var(--text);
    border-radius:6px;
    padding:16px;
    box-shadow:0 2px 8px rgba(0,0,0,.1);
    z-index:1;
    display:flex;
    align-items:center;
    justify-content:center;
    text-align:center;
  }
  .letter p{
    margin:0;
    font-size:14px;
    line-height:1.5;
  }

  /* Umschlag-Vorderseite (deckt Brief ab) */
  .envelope-front{
    position:absolute;
    top:0; left:0; right:0; bottom:0;
    background:var(--body);
    border-radius:10px;
    z-index:2;
    transition:transform 0.8s cubic-bezier(0.4, 0.0, 0.2, 1);
    transform-origin:bottom center;
  }

  /* Dreieckige Klappe */
  .flap{
    position:absolute;
    top:0; left:0; right:0;
    height:90px;
    background:var(--flap);
    clip-path:polygon(0% 0%, 100% 0%, 50% 100%);
    z-index:3;
    transition:transform 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);
    transform-origin:top center;
  }

  /* Herz-Siegel */
  .seal{
    position:absolute;
    top:70px;
    left:50%;
    width:18px;
    height:18px;
    background:var(--seal);
    transform:translate(-50%, -50%) rotate(45deg);
    border-radius:3px 0;
    z-index:4;
    box-shadow:0 2px 8px rgba(251, 24, 227, 0.4);
    transition:all 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);
  }
  .seal::before,
  .seal::after {
    content:'';
    position:absolute;
    width:18px;
    height:18px;
    background:var(--seal);
    border-radius:50%;
  }
  .seal::before { top:-9px; left:0; }
  .seal::after { top:0; left:-9px; }

  /* Ge√∂ffneter Zustand - Klappe klappt nach oben */
  .card.opened .flap{
    transform:rotateX(-180deg);
  }
  
  /* Ge√∂ffneter Zustand - Siegel bewegt sich mit der Klappe */
  .card.opened .seal{
    transform:translate(-50%, -50%) rotate(45deg) rotateX(-180deg);
    opacity:0.3;
  }

  /* Ge√∂ffneter Zustand - Umschlag-Vorderseite wird unsichtbar */
  .card.opened .envelope-front{
    transform:rotateY(-90deg);
    opacity:0;
  }

  /* Footer */
  .card-footer{
    display:flex; 
    gap:12px; 
    align-items:center; 
    justify-content:space-between;
  }
  .card-title{
    margin:0; 
    font-size:16px; 
    font-weight:800; 
    color:#111;
    display:flex; 
    align-items:center; 
    gap:8px;
  }
  .badge{
    font-size:11px; 
    font-weight:700; 
    color:#111;
    background:#fde68a; 
    border:1px dashed var(--accent);
    padding:3px 8px; 
    border-radius:12px;
  }
  .toggle-btn{
    padding:8px 12px;
    border:0; 
    border-radius:8px; 
    font-weight:700; 
    cursor:pointer;
    background:var(--btn);
    font-size:13px;
    transition:all .2s ease;
  }
  .toggle-btn:hover:not(:disabled){
    background:var(--btn-hover);
    transform:translateY(-1px);
  }
  .toggle-btn:disabled{opacity:0.5; cursor:not-allowed; background:#999;}

  @media (max-width: 768px) {
    .grid{
      grid-template-columns:1fr;
    }
  }
</style>
</head>
<body>

<header>
  <h1>üìú Briefe f√ºr dich</h1>
  <div class="meta" id="meta">‚Äì</div>
  <div class="actions">
    <a href="game.html" class="btn primary">‚¨ÖÔ∏è Zur√ºck zum Spiel</a>
    <button id="reset" class="btn light">Score zur√ºcksetzen</button>
  </div>
</header>

<section class="grid" id="grid"></section>

<script>
(() => {
  // Brief-Inhalte
  const MESSAGES = [
    "Liebe/r [Name], dies ist dein erster Brief! Ich freue mich so sehr, dass du das Spiel gemeistert hast. Du bist wirklich besonders! ‚ù§Ô∏è",
    "Brief Nummer 2: Erinnerst du dich noch an [gemeinsame Erinnerung]? Das war einer der sch√∂nsten Momente mit dir! üåü",
    "Der dritte Brief: Deine [positive Eigenschaft] beeindruckt mich immer wieder. Du machst die Welt zu einem besseren Ort! üåà",
    "Brief vier ist da: Egal was passiert, ich bin immer f√ºr dich da. Unsere Freundschaft bedeutet mir unendlich viel! ü§ó",
    "Der letzte Brief: Du hast alle Briefe freigeschaltet! Das zeigt, wie gro√üartig du bist. Ich bin stolz auf dich! üéâ‚ú®"
  ];

  // Score aus Session Storage
  const unlockedCount = parseInt(sessionStorage.getItem('bananaScore') || '0', 10);
  
  const grid = document.getElementById('grid');
  const meta = document.getElementById('meta');
  
  meta.textContent = `Freigeschaltet: ${Math.min(unlockedCount, MESSAGES.length)} / ${MESSAGES.length} (Score: ${unlockedCount})`;

  // Briefe erstellen
  MESSAGES.forEach((message, index) => {
    const isUnlocked = index < unlockedCount;
    
    // Hauptkarte
    const card = document.createElement('div');
    card.className = 'card' + (isUnlocked ? '' : ' locked');
    
    // Umschlag-Container
    const envelope = document.createElement('div');
    envelope.className = 'envelope';
    
    // Brief-Inhalt (Papier) - immer im Hintergrund
    const letter = document.createElement('div');
    letter.className = 'letter';
    const letterText = document.createElement('p');
    letterText.textContent = message;
    letter.appendChild(letterText);
    
    // Umschlag-Vorderseite
    const envelopeFront = document.createElement('div');
    envelopeFront.className = 'envelope-front';
    
    // Klappe
    const flap = document.createElement('div');
    flap.className = 'flap';
    
    // Siegel
    const seal = document.createElement('div');
    seal.className = 'seal';
    
    // Zusammenbauen - richtige Reihenfolge wichtig!
    envelope.appendChild(letter); // Brief ganz unten
    envelope.appendChild(envelopeFront); // Umschlag dar√ºber
    envelope.appendChild(flap); // Klappe dar√ºber
    envelope.appendChild(seal); // Siegel ganz oben
    
    // Footer mit Button
    const footer = document.createElement('div');
    footer.className = 'card-footer';
    
    const title = document.createElement('h3');
    title.className = 'card-title';
    title.innerHTML = `Brief ${index + 1} <span class="badge">${isUnlocked ? 'freigeschaltet' : 'gesperrt'}</span>`;
    
    const button = document.createElement('button');
    button.className = 'toggle-btn';
    button.textContent = isUnlocked ? '√ñffnen' : 'Gesperrt';
    
    if (!isUnlocked) {
      button.disabled = true;
    } else {
      // Event f√ºr √ñffnen/Schlie√üen
      let isOpen = false;
      button.addEventListener('click', () => {
        isOpen = !isOpen;
        if (isOpen) {
          card.classList.add('opened');
          button.textContent = 'Schlie√üen';
        } else {
          card.classList.remove('opened');
          button.textContent = '√ñffnen';
        }
      });
    }
    
    footer.appendChild(title);
    footer.appendChild(button);
    
    card.appendChild(envelope);
    card.appendChild(footer);
    grid.appendChild(card);
  });

  // Reset Button
  document.getElementById('reset').addEventListener('click', () => {
    if (confirm('M√∂chtest du wirklich den Score zur√ºcksetzen? Alle Briefe werden wieder gesperrt.')) {
      sessionStorage.removeItem('bananaScore');
      location.reload();
    }
  });
})();
</script>
</body>
</html>
